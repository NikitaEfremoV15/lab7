@startuml
title Добавление нового умного устройства в систему
actor "Владелец дома" as Owner
actor "Администратор" as Admin
participant "Мобильное приложение" as App
participant "Центральный хаб" as Hub
participant "Облачный сервис" as Cloud
participant "База устройств" as DeviceDB
participant "Новое устройство" as NewDevice

Owner -> App: Открыть раздел "Добавить устройство"
App -> Hub: Запрос на начало сопряжения
Hub --> App: Режим сопряжения активирован

Owner -> NewDevice: Нажать кнопку сопряжения
NewDevice -> Hub: Отправить сигнал обнаружения
Hub -> NewDevice: Запросить идентификатор
NewDevice --> Hub: ID устройства: XYZ123

Hub -> Cloud: Проверить совместимость устройства
Cloud --> Hub: Устройство совместимо, драйвер найден

Hub -> Cloud: Скачать драйвер устройства
Cloud --> Hub: Драйвер загружен

Hub -> NewDevice: Установить соединение
NewDevice --> Hub: Соединение установлено

Hub -> NewDevice: Назначить имя и комнату
NewDevice --> Hub: Настройки приняты

Hub -> DeviceDB: Сохранить информацию об устройстве
DeviceDB --> Hub: Устройство сохранено

Hub -> Cloud: Синхронизировать с облаком
Cloud --> Hub: Синхронизация завершена

Hub --> App: Устройство успешно добавлено
App --> Owner: Уведомление: "Умная лампа добавлена в гостиную"

' Дополнительно: Администратор проверяет
Admin -> Cloud: Проверить новые устройства
Cloud --> Admin: Список новых устройств
Admin -> Cloud: Подтвердить безопасность
Cloud --> Hub: Устройство проверено администратором
Hub --> App: Устройство полностью активировано
@enduml
